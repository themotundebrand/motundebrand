<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order History | The Motunde Brand</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/CVKXV7R.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brandBlack: '#000000',
                        brandPink: '#F7C8D0',
                        brandPinkDark: '#E2A9B3',
                    },
                    letterSpacing: { luxury: '0.4em', refined: '0.15em' }
                }
            }
        }
    </script>
    <style>
        /* Sidebar Transitions */
        .sidebar-closed { transform: translateX(-100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .sidebar-open { transform: translateX(0); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* Card Hover Effects */
        .order-card { transition: all 0.3s ease; border: 1px solid #f9fafb; }
        .order-card:hover { border-color: #F7C8D0; box-shadow: 0 10px 30px -15px rgba(0,0,0,0.05); }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #fff; }
        ::-webkit-scrollbar-thumb { background: #000; }
    </style>
</head>
<body class="bg-white font-sans antialiased text-brandBlack">

    <nav class="fixed w-full z-[150] bg-brandBlack px-4 md:px-8 py-5 flex justify-between items-center border-b border-brandPink/10">
        <div class="flex items-center gap-3">
            <button onclick="toggleSidebar(true)" class="md:hidden text-brandPink p-1">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 8h16M4 16h16" stroke-width="2" stroke-linecap="round"></path></svg>
            </button>
            <h1 class="text-brandPink text-[10px] md:text-lg font-black tracking-luxury uppercase">The Motunde Brand</h1>
        </div>

        <div class="hidden md:flex space-x-8 text-[10px] tracking-widest uppercase text-white/90">
            <a href="index.html" class="hover:text-brandPink transition">Home</a>
            <a href="shop.html" class="hover:text-brandPink transition">Shop</a>
            <a href="membership.html" class="hover:text-brandPink transition">Profile</a>
            <a href="orderhistory.html" class="text-brandPink">Order History</a>
        </div>

        <div class="flex items-center gap-4 text-brandPink">
            <a href="membership.html" class="hover:text-white transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" stroke-width="1.5"></path></svg>
            </a>
            <a href="cart.html" class="relative hover:text-white transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" stroke-width="1.5"></path></svg>
            </a>
        </div>
    </nav>

    <div id="sidebar-overlay" onclick="toggleSidebar(false)" class="fixed inset-0 bg-black/60 z-[160] hidden backdrop-blur-sm"></div>
    <aside id="sidebar" class="fixed top-0 left-0 h-full w-72 bg-brandBlack z-[170] sidebar-closed p-8 flex flex-col">
        <button onclick="toggleSidebar(false)" class="self-end text-brandPink mb-12">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-width="2"></path></svg>
        </button>
        <div class="flex flex-col space-y-8 text-[11px] tracking-[0.3em] uppercase text-brandPink/80">
            <a href="index.html" class="hover:text-brandPink">Home</a>
            <a href="shop.html" class="hover:text-brandPink">Shop Collection</a>
            <a href="orderhistory.html" class="text-white">Order History</a>
            <hr class="border-brandPink/10">
            <a href="membership.html" class="text-[9px] opacity-60">My Profile</a>
        </div>
    </aside>

    <main class="max-w-4xl mx-auto px-4 pt-28 md:pt-36 pb-20">
        <div class="mb-10 md:mb-16 flex flex-col sm:flex-row sm:items-end justify-between gap-6">
            <div class="space-y-2">
                <h2 class="text-2xl md:text-4xl font-light uppercase tracking-luxury">Order History</h2>
                <div class="w-12 h-[1px] bg-brandPink"></div>
                <p class="text-[9px] md:text-[10px] tracking-widest text-brandPinkDark font-bold uppercase">Archived luxury acquisitions</p>
            </div>
            <a href="shop.html" class="text-[9px] font-black uppercase tracking-widest border-b border-brandBlack pb-1 w-max hover:text-brandPinkDark hover:border-brandPinkDark transition">Continue Shopping</a>
        </div>

        <div id="loading-state" class="py-20 text-center">
            <div class="inline-block w-8 h-8 border-2 border-brandPink border-t-brandBlack rounded-full animate-spin"></div>
            <p class="text-[9px] uppercase tracking-widest mt-4 text-gray-400">Consulting Archives...</p>
        </div>

        <div id="empty-state" class="hidden py-16 px-6 text-center bg-gray-50 border border-dashed border-gray-200">
            <p class="text-[10px] uppercase tracking-widest text-gray-400 mb-6">Your acquisition history is currently empty</p>
            <a href="shop.html" class="inline-block bg-brandBlack text-brandPink px-10 py-4 text-[10px] font-bold uppercase tracking-widest hover:bg-brandPink hover:text-brandBlack transition">Explore Collection</a>
        </div>

        <div id="orders-container" class="space-y-8 md:space-y-12"></div>
    </main>

    
<footer class="bg-brandBlack pt-16 pb-10 px-6 md:px-12 border-t border-brandPink/5">
    <div class="max-w-7xl mx-auto mb-16">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
            <div class="col-span-1">
                <h2 class="text-brandPink text-sm font-black tracking-luxury uppercase mb-6">The Motunde Brand</h2>
                <p class="text-brandPink/50 text-[10px] leading-relaxed tracking-widest uppercase max-w-xs">
                    Timeless elegance for the modern individual. Redefining fashion through quality and luxury.
                </p>
            </div>
            <div class="col-span-1 md:col-span-2 grid grid-cols-2 gap-4">
                <div>
                    <h4 class="text-brandPink text-[10px] font-bold tracking-widest uppercase mb-6">Collections</h4>
                    <ul class="text-brandPink/60 text-[9px] space-y-4 tracking-widest uppercase">
                        <li><a href="#women" class="hover:text-brandPink transition">Women</a></li>
                        <li><a href="#men" class="hover:text-brandPink transition">Men</a></li>
                        <li><a href="#kids" class="hover:text-brandPink transition">Kids</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-brandPink text-[10px] font-bold tracking-widest uppercase mb-6">Support</h4>
                    <ul class="text-brandPink/60 text-[9px] space-y-4 tracking-widest uppercase">
                        <li><a href="#" class="hover:text-brandPink transition">Contact</a></li>
                        <li><a href="#" class="hover:text-brandPink transition">Shipping</a></li>
                        <li><a href="#" class="hover:text-brandPink transition">Privacy</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-span-1">
                <h4 class="text-brandPink text-[10px] font-bold tracking-widest uppercase mb-6">Newsletter</h4>
                <div class="flex border-b border-brandPink/20 pb-2">
                    <input type="email" placeholder="YOUR EMAIL" class="bg-transparent text-[10px] text-brandPink w-full focus:outline-none placeholder:text-brandPink/20 tracking-widest">
                    <button class="text-brandPink text-[10px] font-bold ml-2">JOIN</button>
                </div>
            </div>
        </div>
    </div>
    <div class="border-t border-brandPink/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-6">
        <p class="text-brandPink/30 text-[8px] tracking-[0.3em] uppercase order-2 md:order-1">
            © 2026 The Motunde Brand. All Rights Reserved.
        </p>
        <div class="flex flex-wrap justify-center gap-5 md:gap-6 order-1 md:order-2">
            <a href="#" class="text-brandPink/40 hover:text-brandPink transition uppercase text-[8px] tracking-widest">Instagram</a>
            <a href="#" class="text-brandPink/40 hover:text-brandPink transition uppercase text-[8px] tracking-widest">TikTok</a>
            <a href="#" class="text-brandPink/40 hover:text-brandPink transition uppercase text-[8px] tracking-widest">Facebook</a>
        </div>
    </div>
</footer>
  <a href="https://wa.me/2349025291629?text=Hi%20The%20Motunde%20Brand!%20My%20name%20is%20..." 
       target="_blank" 
       class="fixed bottom-6 right-6 z-[150] bg-[#25D366] p-3.5 rounded-full shadow-2xl transition-transform hover:scale-110 active:scale-95 whatsapp-pulse">
        <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
        </svg>
    </a>

    <script>
        function toggleSidebar(open) {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            if (open) {
                sidebar.classList.replace('sidebar-closed', 'sidebar-open');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            } else {
                sidebar.classList.replace('sidebar-open', 'sidebar-closed');
                overlay.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('motunde_token');
            const container = document.getElementById('orders-container');
            const loading = document.getElementById('loading-state');
            const empty = document.getElementById('empty-state');

            if (!token) {
                window.location.href = 'account.html';
                return;
            }

            try {
                const response = await fetch('/api/order/my-orders', {
                    method: 'GET',
                    headers: { 
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) throw new Error("Fetch failed");
                const orders = await response.json();
                
                loading.classList.add('hidden');

                if (!orders || orders.length === 0) {
                    empty.classList.remove('hidden');
                    return;
                }

                container.innerHTML = orders.map(order => `
                    <div class="order-card bg-white p-5 md:p-10">
                        <div class="flex flex-col md:flex-row justify-between items-start gap-4 mb-8 pb-6 border-b border-gray-50">
                            <div class="grid grid-cols-2 md:block gap-4 w-full md:w-auto">
                                <div class="space-y-1">
                                    <p class="text-[7px] md:text-[8px] text-gray-400 uppercase tracking-widest">Order Ref</p>
                                    <h3 class="text-[11px] md:text-sm font-black tracking-widest uppercase">#TMB-${(order._id || 'N/A').slice(-6).toUpperCase()}</h3>
                                </div>
                                <div class="md:mt-4 space-y-1">
                                    <p class="text-[7px] md:text-[8px] text-gray-400 uppercase tracking-widest">Date</p>
                                    <p class="text-[10px] text-gray-500 font-medium">${new Date(order.createdAt).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })}</p>
                                </div>
                            </div>
                            
                            <div class="flex justify-between md:justify-end gap-8 md:gap-16 w-full md:w-auto border-t md:border-0 pt-4 md:pt-0">
                                <div class="space-y-1 text-left md:text-right">
                                    <p class="text-[7px] md:text-[8px] text-gray-400 uppercase tracking-widest">Status</p>
                                    <span class="block text-[9px] md:text-[10px] font-black uppercase tracking-widest text-brandPinkDark">
                                        ${order.status || 'In Review'}
                                    </span>
                                </div>
                                <div class="space-y-1 text-right">
                                    <p class="text-[7px] md:text-[8px] text-gray-400 uppercase tracking-widest">Investment</p>
                                    <p class="text-[12px] md:text-sm font-black">₦${(order.totalPrice || 0).toLocaleString()}</p>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            ${(order.items || []).map(item => `
                                <div class="flex items-center gap-4 md:gap-6 group">
                                    <div class="relative overflow-hidden bg-gray-50 w-16 h-20 md:w-20 md:h-24 flex-shrink-0">
                                        <img src="${item.image || 'https://i.imgur.com/CVKXV7R.png'}" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <h4 class="text-[9px] md:text-[11px] font-bold uppercase tracking-widest truncate">${item.name}</h4>
                                        <p class="text-[8px] md:text-[9px] text-gray-400 uppercase mt-1">Size: ${item.size} • Qty: ${item.quantity}</p>
                                        <p class="md:hidden text-[10px] font-bold mt-1">₦${((item.price || 0) * (item.quantity || 1)).toLocaleString()}</p>
                                    </div>
                                    <p class="hidden md:block text-[11px] font-bold">₦${((item.price || 0) * (item.quantity || 1)).toLocaleString()}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');

            } catch (err) {
                loading.innerHTML = `<p class="text-[9px] uppercase tracking-widest text-red-400">Communication Error. Please refresh the archive.</p>`;
            }
        });
    </script>
</body>
</html>